(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     64708,       1939]
NotebookOptionsPosition[     63452,       1909]
NotebookOutlinePosition[     63848,       1925]
CellTagsIndexPosition[     63805,       1922]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 StyleBox[
  RowBox[{
  "Ternary", " ", "figs", " ", "for", " ", "private", " ", "assessment", " ", 
   "of", " ", "reputations"}], "Title"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"B", ".", " ", "Morsky"}], ",", " ", 
   RowBox[{"J", ".", " ", "Plotkin"}], ",", 
   RowBox[{"E", ".", " ", "Ak\[CCedilla]ay"}]}], "Subtitle"]}], "Input",
 CellChangeTimes->{{3.848527099402308*^9, 3.84852710941495*^9}, {
  3.8665513185547743`*^9, 3.8665513310994587`*^9}, {3.898100204589879*^9, 
  3.898100211947288*^9}},ExpressionUUID->"5e030bec-8390-4399-be93-\
e4edc10a353b"],

Cell[CellGroupData[{

Cell["Global Conditions", "Section",
 CellChangeTimes->{{3.8980971585488873`*^9, 
  3.898097162007374*^9}},ExpressionUUID->"d6016100-be52-4ea9-8b23-\
3aaf25b6f89b"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e1", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e2", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", "3"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Epsilon]", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "e1"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", "e2"}], ")"}]}], "+", 
    RowBox[{"e1", "*", "e2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"e", "=", "e2"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "ternary", " ", "coords", " ", "where", " ", "x", " ", "corresponds", " ",
      "to", " ", "freq", " ", "alld"}], ",", " ", 
    RowBox[{"y", " ", "to", " ", "freq", " ", "allc"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TernCoords", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "/", "2"}], ",", 
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Tan", "[", 
            RowBox[{"Pi", "/", "3"}], "]"}]}], "/", "2"}], ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Tan", "[", 
            RowBox[{"Pi", "/", "3"}], "]"}]}], "/", "2"}]}], "}"}]}], "}"}], 
     ".", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}]}], "+", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"1", "/", "2"}], ",", 
      RowBox[{
       RowBox[{"Tan", "[", 
        RowBox[{"Pi", "/", "3"}], "]"}], "/", "2"}]}], "}"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"diskradius", "=", ".015"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"textoffset", "=", ".05"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"thickness", "=", ".005"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vlabels", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<AllD\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "Large"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "textoffset"}], ",", 
          RowBox[{"-", "textoffset"}]}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"Graphics", "[", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<AllC\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "Large"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "+", "textoffset"}], ",", 
          RowBox[{"-", "textoffset"}]}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"Graphics", "[", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Disc\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "Large"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", "2"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Tan", "[", 
             RowBox[{"Pi", "/", "3"}], "]"}], "/", "2"}], "+", 
           "textoffset"}]}], "}"}]}], "]"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "SetDirectory", "[", 
   "\"\</Users/brycemorsky/Desktop/New projects/Indirect \
reciprocity/figures\>\"", "]"}], ";"}]}], "Input",
 CellLabel->"In[14]:=",ExpressionUUID->"3cb6189c-fe1b-4183-b017-f42f7f66fe2b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Simple Standing", "Section",
 CellChangeTimes->{{3.898097099432253*^9, 
  3.898097100807439*^9}},ExpressionUUID->"3f4fc48e-8f68-4e83-9bd6-\
c8fe8af5a61b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{
    RowBox[{"x", "*", 
     RowBox[{"gx", "[", "t", "]"}]}], "+", 
    RowBox[{"y", "*", 
     RowBox[{"gy", "[", "t", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "x", "-", "y"}], ")"}], "*", 
     RowBox[{"gz", "[", "t", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g2", "=", 
   RowBox[{
    RowBox[{"x", "*", 
     RowBox[{"gx2", "[", "t", "]"}]}], "+", 
    RowBox[{"y", "*", 
     RowBox[{"gy2", "[", "t", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "x", "-", "y"}], ")"}], "*", 
     RowBox[{"gz2", "[", "t", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pcg", "=", 
   RowBox[{"\[Epsilon]", "*", 
    RowBox[{"g", "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Epsilon]", "*", "g"}], "+", 
       RowBox[{"e", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "g"}], ")"}]}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pdg", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Epsilon]"}], ")"}], "*", 
    RowBox[{"g", "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Epsilon]"}], ")"}], "*", "g"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "e"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "g"}], ")"}]}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pcb", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pdb", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Qcg", "=", 
   RowBox[{
    RowBox[{"\[Epsilon]", "*", "Pcg"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Epsilon]"}], ")"}], "*", "Pdg"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Qdg", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "e"}], ")"}], "*", "Pdg"}], "+", 
    RowBox[{"e", "*", "Pcg"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Qcb", "=", 
   RowBox[{
    RowBox[{"\[Epsilon]", "*", "Pcb"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Epsilon]"}], ")"}], "*", "Pdb"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Qdb", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "e"}], ")"}], "*", "Pdb"}], "+", 
    RowBox[{"e", "*", "Pcb"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"repsys", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"gx", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"Qcg", "*", "g"}], "+", "1", "-", "g", "-", 
       RowBox[{"gx", "[", "t", "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gy", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"Qdg", "*", "g"}], "+", "1", "-", "g", "-", 
       RowBox[{"gy", "[", "t", "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gz", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"Qcg", "*", "g2"}], "+", 
       RowBox[{"Qdg", "*", 
        RowBox[{"(", 
         RowBox[{"g", "-", "g2"}], ")"}]}], "+", "1", "-", "g", "-", 
       RowBox[{"gz", "[", "t", "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gx2", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{
        RowBox[{"gx", "[", "t", "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Qcg", "*", "g"}], "+", "1", "-", "g"}], ")"}]}], "-", 
       RowBox[{"gx2", "[", "t", "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gy2", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{
        RowBox[{"gy", "[", "t", "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Qdg", "*", "g"}], "+", "1", "-", "g"}], ")"}]}], "-", 
       RowBox[{"gy2", "[", "t", "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gz2", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{
        RowBox[{"gz", "[", "t", "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Qcg", "*", "g2"}], "+", 
          RowBox[{"Qdg", "*", 
           RowBox[{"(", 
            RowBox[{"g", "-", "g2"}], ")"}]}], "+", "1", "-", "g"}], ")"}]}], 
       "-", 
       RowBox[{"gz2", "[", "t", "]"}]}]}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"m", ",", 
     RowBox[{"{", 
      RowBox[{"66", ",", "5"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"count", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"R", "=", 
      RowBox[{"NDSolve", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"repsys", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "\[Rule]", 
              RowBox[{"0.1", "*", "i"}]}], ",", 
             RowBox[{"y", "\[Rule]", 
              RowBox[{"0.1", "*", "j"}]}]}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"gx", "[", "0", "]"}], "\[Equal]", "0.5"}], ",", 
            RowBox[{
             RowBox[{"gy", "[", "0", "]"}], "\[Equal]", "0.5"}], ",", 
            RowBox[{
             RowBox[{"gz", "[", "0", "]"}], "\[Equal]", "0.5"}], ",", 
            RowBox[{
             RowBox[{"gx2", "[", "0", "]"}], "\[Equal]", "0.25"}], ",", 
            RowBox[{
             RowBox[{"gy2", "[", "0", "]"}], "\[Equal]", "0.25"}], ",", 
            RowBox[{
             RowBox[{"gz2", "[", "0", "]"}], "\[Equal]", "0.25"}]}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "gx", ",", "gy", ",", "gz", ",", "gx2", ",", "gy2", ",", "gz2"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "100"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"M", "[", 
       RowBox[{"[", "count", "]"}], "]"}], "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0.1", "*", "i"}], ",", 
        RowBox[{"0.1", "*", "j"}], ",", 
        RowBox[{
         RowBox[{"gx", "[", "100", "]"}], "/.", 
         RowBox[{"R", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"gy", "[", "100", "]"}], "/.", 
         RowBox[{"R", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"gz", "[", "100", "]"}], "/.", 
         RowBox[{"R", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"count", "=", 
      RowBox[{"count", "+", "1"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "10"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "0", ",", 
      RowBox[{"10", "-", "i"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pix", "=", 
   RowBox[{
    RowBox[{"r", "*", 
     RowBox[{"(", 
      RowBox[{"x", "+", 
       RowBox[{"gx", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "x", "-", "y"}], ")"}]}]}], ")"}]}], "-", "1"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"piy", "=", 
   RowBox[{"r", "*", 
    RowBox[{"(", 
     RowBox[{"x", "+", 
      RowBox[{"gy", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "x", "-", "y"}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"piz", "=", 
   RowBox[{
    RowBox[{"r", "*", 
     RowBox[{"(", 
      RowBox[{"x", "+", 
       RowBox[{"gz", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "x", "-", "y"}], ")"}]}]}], ")"}]}], "-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"gx", "*", "x"}], "+", 
      RowBox[{"gy", "*", "y"}], "+", 
      RowBox[{"gz", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "x", "-", "y"}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"pi", "=", 
   RowBox[{
    RowBox[{"x", "*", "pix"}], "+", 
    RowBox[{"y", "*", "piy"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "x", "-", "y"}], ")"}], "*", "piz"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"xdot", "=", 
   RowBox[{"x", "*", 
    RowBox[{"(", 
     RowBox[{"pix", "-", "pi"}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ydot", "=", 
   RowBox[{"y", "*", 
    RowBox[{"(", 
     RowBox[{"piy", "-", "pi"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vdata", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "xdot", ",", "ydot"}], "}"}], "/.", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "gx", ",", "gy", ",", "gz"}], "}"}], 
          "\[Rule]", "#"}], "]"}], "&"}], "/@", "M"}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Stable", " ", "equilibria"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullsys", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"x", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x", "*", 
         RowBox[{"(", 
          RowBox[{"pix", "-", "pi"}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}], ",", 
          RowBox[{"gx", "\[Rule]", 
           RowBox[{"gx", "[", "t", "]"}]}], ",", 
          RowBox[{"gy", "\[Rule]", 
           RowBox[{"gy", "[", "t", "]"}]}], ",", 
          RowBox[{"gz", "\[Rule]", 
           RowBox[{"gz", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"y", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"y", "*", 
         RowBox[{"(", 
          RowBox[{"piy", "-", "pi"}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}], ",", 
          RowBox[{"gx", "\[Rule]", 
           RowBox[{"gx", "[", "t", "]"}]}], ",", 
          RowBox[{"gy", "\[Rule]", 
           RowBox[{"gy", "[", "t", "]"}]}], ",", 
          RowBox[{"gz", "\[Rule]", 
           RowBox[{"gz", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gx", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10000", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Qcg", "*", "g"}], "+", "1", "-", "g", "-", 
           RowBox[{"gx", "[", "t", "]"}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gy", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10000", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Qdg", "*", "g"}], "+", "1", "-", "g", "-", 
           RowBox[{"gy", "[", "t", "]"}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gz", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10000", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Qcg", "*", "g2"}], "+", 
           RowBox[{"Qdg", "*", 
            RowBox[{"(", 
             RowBox[{"g", "-", "g2"}], ")"}]}], "+", "1", "-", "g", "-", 
           RowBox[{"gz", "[", "t", "]"}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gx2", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10000", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"gx", "[", "t", "]"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Qcg", "*", "g"}], "+", "1", "-", "g"}], ")"}]}], "-", 
           RowBox[{"gx2", "[", "t", "]"}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gy2", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10000", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"gy", "[", "t", "]"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Qdg", "*", "g"}], "+", "1", "-", "g"}], ")"}]}], "-", 
           RowBox[{"gy2", "[", "t", "]"}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gz2", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10000", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"gz", "[", "t", "]"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Qcg", "*", "g2"}], "+", 
              RowBox[{"Qdg", "*", 
               RowBox[{"(", 
                RowBox[{"g", "-", "g2"}], ")"}]}], "+", "1", "-", "g"}], 
             ")"}]}], "-", 
           RowBox[{"gz2", "[", "t", "]"}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}]}], "}"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eqstable", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"m", ",", 
     RowBox[{"{", 
      RowBox[{"81", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"count", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"R", "=", 
      RowBox[{"NDSolve", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"fullsys", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", "0", "]"}], "\[Equal]", 
             RowBox[{"0.00402", "*", "i"}]}], ",", 
            RowBox[{
             RowBox[{"y", "[", "0", "]"}], "\[Equal]", 
             RowBox[{"0.00402", "*", "i"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"gx", "[", "0", "]"}], "\[Equal]", "0.5"}], ",", 
            RowBox[{
             RowBox[{"gy", "[", "0", "]"}], "\[Equal]", "0.5"}], ",", 
            RowBox[{
             RowBox[{"gz", "[", "0", "]"}], "\[Equal]", "0.5"}], ",", 
            RowBox[{
             RowBox[{"gx2", "[", "0", "]"}], "\[Equal]", "0.5"}], ",", 
            RowBox[{
             RowBox[{"gy2", "[", "0", "]"}], "\[Equal]", "0.5"}], ",", 
            RowBox[{
             RowBox[{"gz2", "[", "0", "]"}], "\[Equal]", "0.5"}]}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "x", ",", "y", ",", "gx", ",", "gy", ",", "gz", ",", "gx2", ",", 
          "gy2", ",", "gz2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "100000000"}], "}"}], ",", 
        RowBox[{"Method", "\[Rule]", "\"\<StiffnessSwitching\>\""}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Eqstable", "[", 
       RowBox[{"[", "count", "]"}], "]"}], "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "[", "100000000", "]"}], "/.", 
         RowBox[{"R", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"y", "[", "100000000", "]"}], "/.", 
         RowBox[{"R", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"count", "=", 
      RowBox[{"count", "+", "1"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "80"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dots", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"EdgeForm", "[", 
          RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
         RowBox[{"EdgeForm", "[", "Blue", "]"}], ",", "White", ",", 
         RowBox[{"Disk", "[", 
          RowBox[{
           RowBox[{"TernCoords", "[", 
            RowBox[{"1", ",", "0"}], "]"}], ",", "diskradius"}], "]"}]}], 
        "}"}], "]"}], ",", " ", 
      RowBox[{"(*", " ", "AllC", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"EdgeForm", "[", 
          RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
         RowBox[{"EdgeForm", "[", "Blue", "]"}], ",", "Blue", ",", 
         RowBox[{"Disk", "[", 
          RowBox[{
           RowBox[{"TernCoords", "[", 
            RowBox[{"0", ",", "1"}], "]"}], ",", "diskradius"}], "]"}]}], 
        "}"}], "]"}], ",", " ", 
      RowBox[{"(*", " ", "AllD", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"EdgeForm", "[", 
          RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
         RowBox[{"EdgeForm", "[", "Blue", "]"}], ",", "White", ",", 
         RowBox[{"Disk", "[", 
          RowBox[{
           RowBox[{"TernCoords", "[", 
            RowBox[{"0", ",", "0"}], "]"}], ",", "diskradius"}], "]"}]}], 
        "}"}], "]"}], ",", " ", 
      RowBox[{"(*", " ", "Disc", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"EdgeForm", "[", 
          RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
         RowBox[{"EdgeForm", "[", "Blue", "]"}], ",", "Blue", ",", 
         RowBox[{"Disk", "[", 
          RowBox[{
           RowBox[{"TernCoords", "[", 
            RowBox[{"0", ",", "0.000378589"}], "]"}], ",", "diskradius"}], 
          "]"}]}], "}"}], "]"}]}], 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Stable", " ", "equilibrium", " ", "on", " ", "the", " ", "AllD"}], 
       "-", 
       RowBox[{"Disc", " ", "boundary"}]}], "*)"}], "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dp", "=", 
   RowBox[{"ListStreamPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Partition", "[", 
        RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", "vdata"}], ",", 
     RowBox[{"RegionFunction", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#1", "\[LessEqual]", 
         RowBox[{"1", "-", "#2"}]}], "&"}], ")"}]}], ",", " ", 
     RowBox[{"RegionFillingStyle", "\[Rule]", "None"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"error", ",", "xf"}], "}"}], "=", 
   RowBox[{"FindGeometricTransform", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Tan", "[", 
           RowBox[{"Pi", "/", "3"}], "]"}]}], "}"}], "/", "2"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ternplot", "=", 
   RowBox[{"Graphics", "[", 
    RowBox[{"GeometricTransformation", "[", 
     RowBox[{
      RowBox[{"First", "@", "dp"}], ",", "xf"}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"imageSSBayes", "=", 
   RowBox[{"Show", "[", 
    RowBox[{"ternplot", ",", "dots", ",", "vlabels", ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"PlotRangePadding", "->", ".1"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<SS_private.pdf\>\"", ",", "imageSSBayes"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.898097270778212*^9, 3.898097318567749*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"1b2a97fe-002c-4052-8fb0-b3440c935c25"]
}, Closed]],

Cell[CellGroupData[{

Cell["Staying", "Section",
 CellChangeTimes->{{3.898097063296072*^9, 
  3.8980970641353607`*^9}},ExpressionUUID->"cd319672-bdab-47db-9d6c-\
47cea19b5b37"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{
    RowBox[{"x", "*", 
     RowBox[{"gx", "[", "t", "]"}]}], "+", 
    RowBox[{"y", "*", 
     RowBox[{"gy", "[", "t", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "x", "-", "y"}], ")"}], "*", 
     RowBox[{"gz", "[", "t", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g2", "=", 
   RowBox[{
    RowBox[{"x", "*", 
     RowBox[{"gx2", "[", "t", "]"}]}], "+", 
    RowBox[{"y", "*", 
     RowBox[{"gy2", "[", "t", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "x", "-", "y"}], ")"}], "*", 
     RowBox[{"gz2", "[", "t", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pcg", "=", 
   RowBox[{"\[Epsilon]", "*", 
    RowBox[{"g", "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Epsilon]", "*", "g"}], "+", 
       RowBox[{"e", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "g"}], ")"}]}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pdg", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Epsilon]"}], ")"}], "*", 
    RowBox[{"g", "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Epsilon]"}], ")"}], "*", "g"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "e"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "g"}], ")"}]}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pcb", "=", 
   RowBox[{"e", "*", 
    RowBox[{"g", "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"e", "*", "g"}], "+", 
       RowBox[{"\[Epsilon]", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "g"}], ")"}]}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pdb", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "e"}], ")"}], "*", 
    RowBox[{"g", "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "e"}], ")"}], "*", "g"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Epsilon]"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "g"}], ")"}]}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Qcg", "=", 
   RowBox[{
    RowBox[{"\[Epsilon]", "*", "Pcg"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Epsilon]"}], ")"}], "*", "Pdg"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Qdg", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "e"}], ")"}], "*", "Pdg"}], "+", 
    RowBox[{"e", "*", "Pcg"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Qcb", "=", 
   RowBox[{
    RowBox[{"\[Epsilon]", "*", "Pcb"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Epsilon]"}], ")"}], "*", "Pdb"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Qdb", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "e"}], ")"}], "*", "Pdb"}], "+", 
    RowBox[{"e", "*", "Pcb"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"repsys", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"gx", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"Qcg", "*", "g"}], "-", 
       RowBox[{"g", "*", 
        RowBox[{"gx", "[", "t", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gy", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"Qdg", "*", "g"}], "-", 
       RowBox[{"g", "*", 
        RowBox[{"gy", "[", "t", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gz", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Qcg", "-", "Qdg"}], ")"}], "*", "g2"}], "+", 
       RowBox[{"Qdg", "*", "g"}], "-", 
       RowBox[{"g", "*", 
        RowBox[{"gz", "[", "t", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gx2", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"gx", "[", "t", "]"}], "*", "Qcg"}], "-", 
         RowBox[{"gx2", "[", "t", "]"}]}], ")"}], "*", "g"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gy2", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"gy", "[", "t", "]"}], "*", "Qdg"}], "-", 
         RowBox[{"gy2", "[", "t", "]"}]}], ")"}], "*", "g"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gz2", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{
        RowBox[{"gz", "[", "t", "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Qcg", "-", "Qdg"}], ")"}], "*", "g2"}], "+", 
          RowBox[{"Qdg", "*", "g"}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"gz2", "[", "t", "]"}], "*", "g"}]}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"m", ",", 
     RowBox[{"{", 
      RowBox[{"66", ",", "5"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"count", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"R", "=", 
      RowBox[{"NDSolve", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"repsys", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "\[Rule]", 
              RowBox[{"0.1", "*", "i"}]}], ",", 
             RowBox[{"y", "\[Rule]", 
              RowBox[{"0.1", "*", "j"}]}]}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"gx", "[", "0", "]"}], "\[Equal]", "0.5"}], ",", 
            RowBox[{
             RowBox[{"gy", "[", "0", "]"}], "\[Equal]", "0.5"}], ",", 
            RowBox[{
             RowBox[{"gz", "[", "0", "]"}], "\[Equal]", "0.5"}], ",", 
            RowBox[{
             RowBox[{"gx2", "[", "0", "]"}], "\[Equal]", "0.25"}], ",", 
            RowBox[{
             RowBox[{"gy2", "[", "0", "]"}], "\[Equal]", "0.25"}], ",", 
            RowBox[{
             RowBox[{"gz2", "[", "0", "]"}], "\[Equal]", "0.25"}]}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "gx", ",", "gy", ",", "gz", ",", "gx2", ",", "gy2", ",", "gz2"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "100"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"M", "[", 
       RowBox[{"[", "count", "]"}], "]"}], "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0.1", "*", "i"}], ",", 
        RowBox[{"0.1", "*", "j"}], ",", 
        RowBox[{
         RowBox[{"gx", "[", "100", "]"}], "/.", 
         RowBox[{"R", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"gy", "[", "100", "]"}], "/.", 
         RowBox[{"R", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"gz", "[", "100", "]"}], "/.", 
         RowBox[{"R", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"count", "=", 
      RowBox[{"count", "+", "1"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "10"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "0", ",", 
      RowBox[{"10", "-", "i"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pix", "=", 
   RowBox[{
    RowBox[{"r", "*", 
     RowBox[{"(", 
      RowBox[{"x", "+", 
       RowBox[{"gx", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "x", "-", "y"}], ")"}]}]}], ")"}]}], "-", "1"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"piy", "=", 
   RowBox[{"r", "*", 
    RowBox[{"(", 
     RowBox[{"x", "+", 
      RowBox[{"gy", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "x", "-", "y"}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"piz", "=", 
   RowBox[{
    RowBox[{"r", "*", 
     RowBox[{"(", 
      RowBox[{"x", "+", 
       RowBox[{"gz", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "x", "-", "y"}], ")"}]}]}], ")"}]}], "-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"gx", "*", "x"}], "+", 
      RowBox[{"gy", "*", "y"}], "+", 
      RowBox[{"gz", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "x", "-", "y"}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"pi", "=", 
   RowBox[{
    RowBox[{"x", "*", "pix"}], "+", 
    RowBox[{"y", "*", "piy"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "x", "-", "y"}], ")"}], "*", "piz"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"xdot", "=", 
   RowBox[{"x", "*", 
    RowBox[{"(", 
     RowBox[{"pix", "-", "pi"}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ydot", "=", 
   RowBox[{"y", "*", 
    RowBox[{"(", 
     RowBox[{"piy", "-", "pi"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vdata", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "xdot", ",", "ydot"}], "}"}], "/.", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "gx", ",", "gy", ",", "gz"}], "}"}], 
          "\[Rule]", "#"}], "]"}], "&"}], "/@", "M"}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Stable", " ", "equilibria"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullsys", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"x", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x", "*", 
         RowBox[{"(", 
          RowBox[{"pix", "-", "pi"}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}], ",", 
          RowBox[{"gx", "\[Rule]", 
           RowBox[{"gx", "[", "t", "]"}]}], ",", 
          RowBox[{"gy", "\[Rule]", 
           RowBox[{"gy", "[", "t", "]"}]}], ",", 
          RowBox[{"gz", "\[Rule]", 
           RowBox[{"gz", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"y", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"y", "*", 
         RowBox[{"(", 
          RowBox[{"piy", "-", "pi"}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}], ",", 
          RowBox[{"gx", "\[Rule]", 
           RowBox[{"gx", "[", "t", "]"}]}], ",", 
          RowBox[{"gy", "\[Rule]", 
           RowBox[{"gy", "[", "t", "]"}]}], ",", 
          RowBox[{"gz", "\[Rule]", 
           RowBox[{"gz", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gx", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10000", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Qcg", "*", "g"}], "-", 
           RowBox[{"g", "*", 
            RowBox[{"gx", "[", "t", "]"}]}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gy", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10000", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Qdg", "*", "g"}], "-", 
           RowBox[{"g", "*", 
            RowBox[{"gy", "[", "t", "]"}]}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gz", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10000", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Qcg", "-", "Qdg"}], ")"}], "*", "g2"}], "+", 
           RowBox[{"Qdg", "*", "g"}], "-", 
           RowBox[{"g", "*", 
            RowBox[{"gz", "[", "t", "]"}]}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gx2", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10000", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"gx", "[", "t", "]"}], "*", "Qcg"}], "-", 
           RowBox[{"gx2", "[", "t", "]"}]}], ")"}], "*", "g"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gy2", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10000", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"gy", "[", "t", "]"}], "*", "Qdg"}], "-", 
           RowBox[{"gy2", "[", "t", "]"}]}], ")"}], "*", "g"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gz2", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10000", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"gz", "[", "t", "]"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Qcg", "-", "Qdg"}], ")"}], "*", "g2"}], "+", 
              RowBox[{"Qdg", "*", "g"}]}], ")"}]}], "-", 
           RowBox[{
            RowBox[{"gz2", "[", "t", "]"}], "*", "g"}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}]}], "}"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eqstable", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"m", ",", 
     RowBox[{"{", 
      RowBox[{"81", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"count", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"R", "=", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"fullsys", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"0.00402", "*", "i"}]}], ",", 
             RowBox[{
              RowBox[{"y", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"0.00402", "*", "i"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"gx", "[", "0", "]"}], "\[Equal]", "0.5"}], ",", 
             RowBox[{
              RowBox[{"gy", "[", "0", "]"}], "\[Equal]", "0.5"}], ",", 
             RowBox[{
              RowBox[{"gz", "[", "0", "]"}], "\[Equal]", "0.5"}], ",", 
             RowBox[{
              RowBox[{"gx2", "[", "0", "]"}], "\[Equal]", "0.5"}], ",", 
             RowBox[{
              RowBox[{"gy2", "[", "0", "]"}], "\[Equal]", "0.5"}], ",", 
             RowBox[{
              RowBox[{"gz2", "[", "0", "]"}], "\[Equal]", "0.5"}]}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "x", ",", "y", ",", "gx", ",", "gy", ",", "gz", ",", "gx2", ",", 
           "gy2", ",", "gz2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "100000000"}], "}"}], ",", 
         RowBox[{"Method", "\[Rule]", "\"\<StiffnessSwitching\>\""}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eqstable", "[", 
        RowBox[{"[", "count", "]"}], "]"}], "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "100000000", "]"}], "/.", 
          RowBox[{"R", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"y", "[", "100000000", "]"}], "/.", 
          RowBox[{"R", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"count", "=", 
       RowBox[{"count", "+", "1"}]}], ";"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "80"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Unstable", " ", "equilibria"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"negfullsys", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"x", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "x"}], "*", 
         RowBox[{"(", 
          RowBox[{"pix", "-", "pi"}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}], ",", 
          RowBox[{"gx", "\[Rule]", 
           RowBox[{"gx", "[", "t", "]"}]}], ",", 
          RowBox[{"gy", "\[Rule]", 
           RowBox[{"gy", "[", "t", "]"}]}], ",", 
          RowBox[{"gz", "\[Rule]", 
           RowBox[{"gz", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"y", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "y"}], "*", 
         RowBox[{"(", 
          RowBox[{"piy", "-", "pi"}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}], ",", 
          RowBox[{"gx", "\[Rule]", 
           RowBox[{"gx", "[", "t", "]"}]}], ",", 
          RowBox[{"gy", "\[Rule]", 
           RowBox[{"gy", "[", "t", "]"}]}], ",", 
          RowBox[{"gz", "\[Rule]", 
           RowBox[{"gz", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gx", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10000", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Qcg", "*", "g"}], "-", 
           RowBox[{"g", "*", 
            RowBox[{"gx", "[", "t", "]"}]}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gy", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10000", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Qdg", "*", "g"}], "-", 
           RowBox[{"g", "*", 
            RowBox[{"gy", "[", "t", "]"}]}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gz", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10000", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Qcg", "-", "Qdg"}], ")"}], "*", "g2"}], "+", 
           RowBox[{"Qdg", "*", "g"}], "-", 
           RowBox[{"g", "*", 
            RowBox[{"gz", "[", "t", "]"}]}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gx2", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10000", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"gx", "[", "t", "]"}], "*", "Qcg"}], "-", 
           RowBox[{"gx2", "[", "t", "]"}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gy2", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10000", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"gy", "[", "t", "]"}], "*", "Qdg"}], "-", 
           RowBox[{"gy2", "[", "t", "]"}]}], ")"}], "*", "g"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gz2", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10000", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"gz", "[", "t", "]"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Qcg", "-", "Qdg"}], ")"}], "*", "g2"}], "+", 
              RowBox[{"Qdg", "*", "g"}]}], ")"}]}], "-", 
           RowBox[{
            RowBox[{"gz2", "[", "t", "]"}], "*", "g"}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}]}], "}"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Equnstable", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"m", ",", 
     RowBox[{"{", 
      RowBox[{"81", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"count", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"negR", "=", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"negfullsys", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"0.00402", "*", "i"}]}], ",", 
             RowBox[{
              RowBox[{"y", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"0.00402", "*", "i"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"gx", "[", "0", "]"}], "\[Equal]", "0.5"}], ",", 
             RowBox[{
              RowBox[{"gy", "[", "0", "]"}], "\[Equal]", "0.5"}], ",", 
             RowBox[{
              RowBox[{"gz", "[", "0", "]"}], "\[Equal]", "0.5"}], ",", 
             RowBox[{
              RowBox[{"gx2", "[", "0", "]"}], "\[Equal]", "0.25"}], ",", 
             RowBox[{
              RowBox[{"gy2", "[", "0", "]"}], "\[Equal]", "0.25"}], ",", 
             RowBox[{
              RowBox[{"gz2", "[", "0", "]"}], "\[Equal]", "0.25"}]}], "}"}]}],
           "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "x", ",", "y", ",", "gx", ",", "gy", ",", "gz", ",", "gx2", ",", 
           "gy2", ",", "gz2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "1000"}], "}"}], ",", 
         RowBox[{"Method", "\[Rule]", "\"\<StiffnessSwitching\>\""}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Equnstable", "[", 
        RowBox[{"[", "count", "]"}], "]"}], "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "1000", "]"}], "/.", 
          RowBox[{"negR", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"y", "[", "1000", "]"}], "/.", 
          RowBox[{"negR", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"count", "=", 
       RowBox[{"count", "+", "1"}]}], ";"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "80"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dots", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "Blue", "]"}], ",", "White", ",", 
        RowBox[{"Disk", "[", 
         RowBox[{
          RowBox[{"TernCoords", "[", 
           RowBox[{"1", ",", "0"}], "]"}], ",", "diskradius"}], "]"}]}], 
       "}"}], "]"}], ",", " ", 
     RowBox[{"(*", " ", "AllC", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "Blue", "]"}], ",", "Blue", ",", 
        RowBox[{"Disk", "[", 
         RowBox[{
          RowBox[{"TernCoords", "[", 
           RowBox[{"0", ",", "1"}], "]"}], ",", "diskradius"}], "]"}]}], 
       "}"}], "]"}], ",", " ", 
     RowBox[{"(*", " ", "AllD", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "Blue", "]"}], ",", "Blue", ",", 
        RowBox[{"Disk", "[", 
         RowBox[{
          RowBox[{"TernCoords", "[", 
           RowBox[{"0", ",", "0"}], "]"}], ",", "diskradius"}], "]"}]}], 
       "}"}], "]"}], ",", " ", 
     RowBox[{"(*", " ", "Disc", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
        RowBox[{"CapForm", "[", "\"\<Round\>\"", "]"}], ",", 
        RowBox[{"PointSize", "[", 
         RowBox[{"diskradius", "+", 
          RowBox[{"thickness", "*", "2"}]}], "]"}], ",", "Red", ",", 
        RowBox[{"Point", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"TernCoords", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "&"}], "@@@", "Equnstable"}], 
         "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
        RowBox[{"CapForm", "[", "\"\<Round\>\"", "]"}], ",", 
        RowBox[{"PointSize", "[", 
         RowBox[{"diskradius", "+", 
          RowBox[{"thickness", "*", "2"}]}], "]"}], ",", "Blue", ",", 
        RowBox[{"Point", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"TernCoords", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "&"}], "@@@", "Eqstable"}], 
         "]"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dp", "=", 
   RowBox[{"ListStreamPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Partition", "[", 
        RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", "vdata"}], ",", 
     RowBox[{"RegionFunction", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#1", "\[LessEqual]", 
         RowBox[{"1", "-", "#2"}]}], "&"}], ")"}]}], ",", " ", 
     RowBox[{"RegionFillingStyle", "\[Rule]", "None"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"error", ",", "xf"}], "}"}], "=", 
   RowBox[{"FindGeometricTransform", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Tan", "[", 
           RowBox[{"Pi", "/", "3"}], "]"}]}], "}"}], "/", "2"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ternplot", "=", 
   RowBox[{"Graphics", "[", 
    RowBox[{"GeometricTransformation", "[", 
     RowBox[{
      RowBox[{"First", "@", "dp"}], ",", "xf"}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"imageStBayes", "=", 
    RowBox[{"Show", "[", 
     RowBox[{"ternplot", ",", "dots", ",", "vlabels", ",", " ", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
      RowBox[{"PlotRangePadding", "->", ".1"}]}], "]"}]}], ";"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<St_private.pdf\>\"", ",", "imageStBayes"}], "]"}], 
  ";"}]}], "Input",
 CellLabel->"In[66]:=",ExpressionUUID->"71913f47-ba4f-45cb-942b-e179ec422ee5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Stern Judging", "Section",
 CellChangeTimes->{{3.898097020880183*^9, 
  3.898097023103355*^9}},ExpressionUUID->"ca4eb6eb-5cad-4b91-924e-\
148442293498"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pix", "=", 
   RowBox[{
    RowBox[{"r", "*", 
     RowBox[{"(", 
      RowBox[{"x", "+", 
       RowBox[{"0.5", "*", "z"}]}], ")"}]}], "-", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"piy", "=", 
   RowBox[{"r", "*", 
    RowBox[{"(", 
     RowBox[{"x", "+", 
      RowBox[{"0.5", "*", "z"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"piz", "=", 
   RowBox[{
    RowBox[{"r", "*", 
     RowBox[{"(", 
      RowBox[{"x", "+", 
       RowBox[{"0.5", "*", "z"}]}], ")"}]}], "-", "0.5"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"pi", "=", 
    RowBox[{
     RowBox[{"x", "*", "pix"}], "+", 
     RowBox[{"y", "*", "piy"}], "+", 
     RowBox[{"z", "*", "piz"}]}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xdot", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], "=", 
   RowBox[{"x", "*", 
    RowBox[{"(", 
     RowBox[{"pix", "-", "pi"}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ydot", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], "=", 
   RowBox[{"y", "*", 
    RowBox[{"(", 
     RowBox[{"piy", "-", "pi"}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"zdot", "[", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], "=", 
    RowBox[{"z", "*", 
     RowBox[{"(", 
      RowBox[{"piz", "-", "pi"}], ")"}]}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vx", "=", 
   RowBox[{"xdot", "[", 
    RowBox[{"x", ",", "y", ",", 
     RowBox[{"1", "-", "y", "-", "x"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"vy", "=", 
    RowBox[{"ydot", "[", 
     RowBox[{"x", ",", "y", ",", 
      RowBox[{"1", "-", "y", "-", "x"}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dots", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"EdgeForm", "[", 
          RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
         RowBox[{"EdgeForm", "[", "Blue", "]"}], ",", "Blue", ",", 
         RowBox[{"Disk", "[", 
          RowBox[{
           RowBox[{"TernCoords", "[", 
            RowBox[{"0", ",", "1"}], "]"}], ",", "diskradius"}], "]"}]}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"EdgeForm", "[", 
          RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
         RowBox[{"EdgeForm", "[", "Blue", "]"}], ",", "White", ",", 
         RowBox[{"Disk", "[", 
          RowBox[{
           RowBox[{"TernCoords", "[", 
            RowBox[{"1", ",", "0"}], "]"}], ",", "diskradius"}], "]"}]}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"EdgeForm", "[", 
          RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
         RowBox[{"EdgeForm", "[", "Blue", "]"}], ",", "White", ",", 
         RowBox[{"Disk", "[", 
          RowBox[{
           RowBox[{"TernCoords", "[", 
            RowBox[{"0", ",", "0"}], "]"}], ",", "diskradius"}], "]"}]}], 
        "}"}], "]"}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dp", "=", 
   RowBox[{"StreamPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vx", ",", "vy"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"RegionFunction", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#1", "\[LessEqual]", 
         RowBox[{"1", "-", "#2"}]}], "&"}], ")"}]}], ",", " ", 
     RowBox[{"RegionFillingStyle", "\[Rule]", "None"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"error", ",", "xf"}], "}"}], "=", 
   RowBox[{"FindGeometricTransform", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Tan", "[", 
           RowBox[{"Pi", "/", "3"}], "]"}]}], "}"}], "/", "2"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ternplot", "=", 
   RowBox[{"Graphics", "[", 
    RowBox[{"GeometricTransformation", "[", 
     RowBox[{
      RowBox[{"First", "@", "dp"}], ",", "xf"}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"imageSJ", "=", 
    RowBox[{"Show", "[", 
     RowBox[{"ternplot", ",", "dots", ",", "vlabels", ",", " ", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
      RowBox[{"PlotRangePadding", "->", ".1"}]}], "]"}]}], ";"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<SJ_private.pdf\>\"", ",", "imageSJ"}], "]"}], ";"}]}], "Input",\

 CellChangeTimes->{{3.898097028369011*^9, 
  3.898097029303822*^9}},ExpressionUUID->"07a46ebd-f117-4087-99be-\
7d4be5e686e6"]
}, Closed]]
},
WindowSize->{858, 782},
WindowMargins->{{Automatic, 265}, {-29, Automatic}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e631bc4b-3067-42ab-8042-d058c3f3a2fa"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 593, 13, 170, "Input",ExpressionUUID->"5e030bec-8390-4399-be93-e4edc10a353b"],
Cell[CellGroupData[{
Cell[1176, 37, 164, 3, 67, "Section",ExpressionUUID->"d6016100-be52-4ea9-8b23-3aaf25b6f89b"],
Cell[1343, 42, 3590, 109, 376, "Input",ExpressionUUID->"3cb6189c-fe1b-4183-b017-f42f7f66fe2b"]
}, Closed]],
Cell[CellGroupData[{
Cell[4970, 156, 160, 3, 53, "Section",ExpressionUUID->"3f4fc48e-8f68-4e83-9bd6-c8fe8af5a61b"],
Cell[5133, 161, 21686, 644, 1543, "Input",ExpressionUUID->"1b2a97fe-002c-4052-8fb0-b3440c935c25"]
}, Closed]],
Cell[CellGroupData[{
Cell[26856, 810, 154, 3, 53, "Section",ExpressionUUID->"cd319672-bdab-47db-9d6c-47cea19b5b37"],
Cell[27013, 815, 30892, 916, 2005, "Input",ExpressionUUID->"71913f47-ba4f-45cb-942b-e179ec422ee5"]
}, Closed]],
Cell[CellGroupData[{
Cell[57942, 1736, 158, 3, 53, "Section",ExpressionUUID->"ca4eb6eb-5cad-4b91-924e-148442293498"],
Cell[58103, 1741, 5333, 165, 619, "Input",ExpressionUUID->"07a46ebd-f117-4087-99be-7d4be5e686e6"]
}, Closed]]
}
]
*)

