(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     75250,       2004]
NotebookOptionsPosition[     74223,       1978]
NotebookOutlinePosition[     74617,       1994]
CellTagsIndexPosition[     74574,       1991]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 StyleBox[
  RowBox[{
  "Ternary", " ", "figs", " ", "for", " ", "public", " ", "assessment", " ", 
   "of", " ", "reputations", " ", "with", " ", "bias"}], "Section"]], "Input",\

 CellChangeTimes->{{3.8487623116768827`*^9, 3.848762312548237*^9}, {
  3.862311026263143*^9, 3.8623110293204193`*^9}, {3.866552273082242*^9, 
  3.866552282354454*^9}},ExpressionUUID->"bf8c67b6-ba16-4aae-98d6-\
06b042e6a711"],

Cell[CellGroupData[{

Cell[BoxData[{
 StyleBox[
  RowBox[{"Global", " ", "Conditions"}], "Subsection"], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e1", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e2", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", "3"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Epsilon]", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "e1"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", "e2"}], ")"}]}], "+", 
    RowBox[{"e1", "*", "e2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"e", "=", "e2"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "ternary", " ", "coords", " ", "where", " ", "x", " ", "corresponds", " ",
      "to", " ", "freq", " ", "alld"}], ",", " ", 
    RowBox[{"y", " ", "to", " ", "freq", " ", "allc"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TernCoords", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "/", "2"}], ",", 
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Tan", "[", 
            RowBox[{"Pi", "/", "3"}], "]"}]}], "/", "2"}], ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Tan", "[", 
            RowBox[{"Pi", "/", "3"}], "]"}]}], "/", "2"}]}], "}"}]}], "}"}], 
     ".", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}]}], "+", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"1", "/", "2"}], ",", 
      RowBox[{
       RowBox[{"Tan", "[", 
        RowBox[{"Pi", "/", "3"}], "]"}], "/", "2"}]}], "}"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"diskradius", "=", ".015"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"textoffset", "=", ".05"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"thickness", "=", ".005"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vlabels", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<AllD\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "Large"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "textoffset"}], ",", 
          RowBox[{"-", "textoffset"}]}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"Graphics", "[", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<AllC\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "Large"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "+", "textoffset"}], ",", 
          RowBox[{"-", "textoffset"}]}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"Graphics", "[", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Disc\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "Large"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", "2"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Tan", "[", 
             RowBox[{"Pi", "/", "3"}], "]"}], "/", "2"}], "+", 
           "textoffset"}]}], "}"}]}], "]"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "SetDirectory", "[", 
   "\"\</Users/brycemorsky/Desktop/New projects/Indirect \
reciprocity/figures\>\"", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.810146702102693*^9, 3.810146702629282*^9}, 
   3.8101470413955793`*^9, {3.811078117383377*^9, 3.8110781563328657`*^9}, {
   3.8110784315237637`*^9, 3.8110784343552647`*^9}, 3.811079378534107*^9, {
   3.81109130946281*^9, 3.8110913568293257`*^9}, {3.811091520558524*^9, 
   3.811091523492743*^9}, {3.8110929704607*^9, 3.8110929743060713`*^9}, {
   3.81109302965024*^9, 3.81109303711349*^9}, {3.8380823988140707`*^9, 
   3.83808240406509*^9}, {3.8380831212711077`*^9, 3.838083121735374*^9}, {
   3.83808336255334*^9, 3.838083365958988*^9}, {3.83812686826928*^9, 
   3.8381268994589148`*^9}, {3.83812848472618*^9, 3.838128485485022*^9}, {
   3.838254892450645*^9, 3.8382550404019527`*^9}, {3.8389542409095163`*^9, 
   3.8389542411249857`*^9}, {3.839618268580386*^9, 3.839618272225026*^9}, {
   3.839618373751114*^9, 3.839618375924511*^9}, {3.83961853692327*^9, 
   3.839618538728228*^9}, {3.839618601538516*^9, 3.839618637442195*^9}, {
   3.839618682364626*^9, 3.839618683554467*^9}, {3.83961874391741*^9, 
   3.8396187454666767`*^9}, {3.839623699356394*^9, 3.83962370611934*^9}, {
   3.8396368445876102`*^9, 3.8396368457086973`*^9}, {3.8396369222991943`*^9, 
   3.839636925312256*^9}, {3.839637007176836*^9, 3.839637008798258*^9}, {
   3.8396400247825127`*^9, 3.839640026299512*^9}, 3.84006689909029*^9, {
   3.8400672545614557`*^9, 3.840067287095302*^9}, {3.8400673287532377`*^9, 
   3.840067353477597*^9}, {3.840067494462913*^9, 3.8400675271277027`*^9}, {
   3.840067654653203*^9, 3.840067655924217*^9}, 3.840110396301882*^9, {
   3.840110574406974*^9, 3.840110575076317*^9}, {3.840209619312316*^9, 
   3.840209619501841*^9}, {3.84020966541476*^9, 3.840209679901278*^9}, {
   3.842708405064138*^9, 3.842708419017427*^9}, {3.8427117296443443`*^9, 
   3.842711729705079*^9}, {3.842711787377451*^9, 3.8427117897025957`*^9}, {
   3.8427119591789103`*^9, 3.842711959695476*^9}, {3.8429604682990026`*^9, 
   3.842960487778535*^9}, 3.842960675108585*^9, 3.8429607504970007`*^9, {
   3.842960850565628*^9, 3.8429608819416656`*^9}, {3.842965911039423*^9, 
   3.842965911406179*^9}, {3.843424281434841*^9, 3.843424285208116*^9}, {
   3.8434279359972267`*^9, 3.843427936425537*^9}, 3.844266992717663*^9, {
   3.848762325985227*^9, 3.848762343273733*^9}, {3.848763714859332*^9, 
   3.848763715094809*^9}, {3.84883543593638*^9, 3.848835437142414*^9}, 
   3.848835647972224*^9, {3.848836090959902*^9, 3.848836091189725*^9}, {
   3.848836167906478*^9, 3.848836168376597*^9}, {3.848874275900959*^9, 
   3.84887427625852*^9}, {3.8488744945550756`*^9, 3.848874498415682*^9}, {
   3.848874681339944*^9, 3.848874681576289*^9}, {3.84887785064079*^9, 
   3.8488778512144403`*^9}, {3.848878337377287*^9, 3.848878337829509*^9}, {
   3.84887931512821*^9, 3.848879315568048*^9}, {3.8488831584429398`*^9, 
   3.848883159095304*^9}, {3.848883200283832*^9, 3.848883201866111*^9}, 
   3.848886256741777*^9, 3.8497059887935867`*^9, {3.8665522921797256`*^9, 
   3.866552292677721*^9}},
 CellLabel->
  "In[556]:=",ExpressionUUID->"af75f178-2c48-4a0b-afa3-52a0219f9de8"],

Cell[BoxData[
 RowBox[{"Conditions", " ", "Global"}]], "Output",
 CellChangeTimes->{3.898128925781098*^9},
 CellLabel->
  "Out[556]=",ExpressionUUID->"eb866e2d-4f37-40f9-9c9f-a4b11d409527"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 StyleBox[
  RowBox[{"Scoring", " ", "with", " ", "positive", " ", "bias"}], 
  "Section"], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bias", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]", "=", "0.25"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{
    RowBox[{"x", "*", 
     RowBox[{"gx", "[", "t", "]"}]}], "+", 
    RowBox[{"y", "*", 
     RowBox[{"gy", "[", "t", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "x", "-", "y"}], ")"}], "*", 
     RowBox[{"gz", "[", "t", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gb", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Lambda]"}], ")"}], "*", "g"}], "+", 
    RowBox[{"\[Lambda]", "*", "bias"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pcg", "=", 
   RowBox[{"\[Epsilon]", "*", 
    RowBox[{"gb", "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Epsilon]", "*", "gb"}], "+", 
       RowBox[{"e", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "gb"}], ")"}]}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pdg", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Epsilon]"}], ")"}], "*", 
    RowBox[{"gb", "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Epsilon]"}], ")"}], "*", "gb"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "e"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "gb"}], ")"}]}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pcb", "=", "Pcg"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pdb", "=", "Pdg"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Qcg", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "*", "Pcg"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Epsilon]"}], ")"}], "*", "Pdg"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Qdg", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "e"}], ")"}], "*", "Pdg"}], "+", 
     RowBox[{"e", "*", "Pcg"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Qcb", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "*", "Pcb"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Epsilon]"}], ")"}], "*", "Pdb"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Qdb", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "e"}], ")"}], "*", "Pdb"}], "+", 
     RowBox[{"e", "*", "Pcb"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"repsys", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"gx", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"Qcg", "-", 
       RowBox[{"gx", "[", "t", "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gy", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"Qdg", "-", 
       RowBox[{"gy", "[", "t", "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gz", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"Qcg", "*", "g"}], "+", 
       RowBox[{"Qdg", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "g"}], ")"}]}], "-", 
       RowBox[{"gz", "[", "t", "]"}]}]}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"m", ",", 
     RowBox[{"{", 
      RowBox[{"5151", ",", "5"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"count", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"R", "=", 
      RowBox[{"NDSolve", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"repsys", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "\[Rule]", 
              RowBox[{"0.01", "*", "i"}]}], ",", 
             RowBox[{"y", "\[Rule]", 
              RowBox[{"0.01", "*", "j"}]}]}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"gx", "[", "0", "]"}], "\[Equal]", "0.1"}], ",", 
            RowBox[{
             RowBox[{"gy", "[", "0", "]"}], "\[Equal]", "0.2"}], ",", 
            RowBox[{
             RowBox[{"gz", "[", "0", "]"}], "\[Equal]", "0.3"}]}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"gx", ",", "gy", ",", "gz"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "100000"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"M", "[", 
       RowBox[{"[", "count", "]"}], "]"}], "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0.01", "*", "i"}], ",", 
        RowBox[{"0.01", "*", "j"}], ",", 
        RowBox[{
         RowBox[{"gx", "[", "100000", "]"}], "/.", 
         RowBox[{"R", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"gy", "[", "100000", "]"}], "/.", 
         RowBox[{"R", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"gz", "[", "100000", "]"}], "/.", 
         RowBox[{"R", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"count", "=", 
      RowBox[{"count", "+", "1"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "100"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "0", ",", 
      RowBox[{"100", "-", "i"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pix", "=", 
   RowBox[{
    RowBox[{"r", "*", 
     RowBox[{"(", 
      RowBox[{"x", "+", 
       RowBox[{"gx", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "x", "-", "y"}], ")"}]}]}], ")"}]}], "-", "1"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"piy", "=", 
   RowBox[{"r", "*", 
    RowBox[{"(", 
     RowBox[{"x", "+", 
      RowBox[{"gy", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "x", "-", "y"}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"piz", "=", 
   RowBox[{
    RowBox[{"r", "*", 
     RowBox[{"(", 
      RowBox[{"x", "+", 
       RowBox[{"gz", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "x", "-", "y"}], ")"}]}]}], ")"}]}], "-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"gx", "*", "x"}], "+", 
      RowBox[{"gy", "*", "y"}], "+", 
      RowBox[{"gz", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "x", "-", "y"}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"pi", "=", 
   RowBox[{
    RowBox[{"x", "*", "pix"}], "+", 
    RowBox[{"y", "*", "piy"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "x", "-", "y"}], ")"}], "*", "piz"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"xdot", "=", 
   RowBox[{"x", "*", 
    RowBox[{"(", 
     RowBox[{"pix", "-", "pi"}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ydot", "=", 
   RowBox[{"y", "*", 
    RowBox[{"(", 
     RowBox[{"piy", "-", "pi"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vdata", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "xdot", ",", "ydot"}], "}"}], "/.", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "gx", ",", "gy", ",", "gz"}], "}"}], 
          "\[Rule]", "#"}], "]"}], "&"}], "/@", "M"}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Stable", " ", "equilibria"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullsys", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"x", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x", "*", 
         RowBox[{"(", 
          RowBox[{"pix", "-", "pi"}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}], ",", 
          RowBox[{"gx", "\[Rule]", 
           RowBox[{"gx", "[", "t", "]"}]}], ",", 
          RowBox[{"gy", "\[Rule]", 
           RowBox[{"gy", "[", "t", "]"}]}], ",", 
          RowBox[{"gz", "\[Rule]", 
           RowBox[{"gz", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"y", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"y", "*", 
         RowBox[{"(", 
          RowBox[{"piy", "-", "pi"}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}], ",", 
          RowBox[{"gx", "\[Rule]", 
           RowBox[{"gx", "[", "t", "]"}]}], ",", 
          RowBox[{"gy", "\[Rule]", 
           RowBox[{"gy", "[", "t", "]"}]}], ",", 
          RowBox[{"gz", "\[Rule]", 
           RowBox[{"gz", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gx", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10000", "*", 
         RowBox[{"(", 
          RowBox[{"Qcg", "-", 
           RowBox[{"gx", "[", "t", "]"}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gy", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10000", "*", 
         RowBox[{"(", 
          RowBox[{"Qdg", "-", 
           RowBox[{"gy", "[", "t", "]"}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gz", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10000", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Qcg", "*", "g"}], "+", 
           RowBox[{"Qdg", "*", 
            RowBox[{"(", 
             RowBox[{"1", "-", "g"}], ")"}]}], "-", 
           RowBox[{"gz", "[", "t", "]"}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}]}], "}"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eqstable", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"m", ",", 
     RowBox[{"{", 
      RowBox[{"81", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"count", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"R", "=", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"fullsys", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"0.00402", "*", "i"}]}], ",", 
             RowBox[{
              RowBox[{"y", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"0.00402", "*", "i"}]}], ",", 
             RowBox[{
              RowBox[{"gx", "[", "0", "]"}], "\[Equal]", "0.5"}], ",", 
             RowBox[{
              RowBox[{"gy", "[", "0", "]"}], "\[Equal]", "0.5"}], ",", 
             RowBox[{
              RowBox[{"gz", "[", "0", "]"}], "\[Equal]", "0.5"}]}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "gx", ",", "gy", ",", "gz"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "1000000"}], "}"}], ",", 
         RowBox[{"Method", "\[Rule]", "\"\<StiffnessSwitching\>\""}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eqstable", "[", 
        RowBox[{"[", "count", "]"}], "]"}], "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "1000000", "]"}], "/.", 
          RowBox[{"R", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"y", "[", "1000000", "]"}], "/.", 
          RowBox[{"R", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"count", "=", 
       RowBox[{"count", "+", "1"}]}], ";"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "80"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Unstable", " ", "equilibria"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullsys", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"x", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x", "*", 
          RowBox[{"(", 
           RowBox[{"pix", "-", "pi"}], ")"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "\[Rule]", 
            RowBox[{"x", "[", "t", "]"}]}], ",", 
           RowBox[{"y", "\[Rule]", 
            RowBox[{"y", "[", "t", "]"}]}], ",", 
           RowBox[{"gx", "\[Rule]", 
            RowBox[{"gx", "[", "t", "]"}]}], ",", 
           RowBox[{"gy", "\[Rule]", 
            RowBox[{"gy", "[", "t", "]"}]}], ",", 
           RowBox[{"gz", "\[Rule]", 
            RowBox[{"gz", "[", "t", "]"}]}]}], "}"}]}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"y", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"y", "*", 
          RowBox[{"(", 
           RowBox[{"piy", "-", "pi"}], ")"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "\[Rule]", 
            RowBox[{"x", "[", "t", "]"}]}], ",", 
           RowBox[{"y", "\[Rule]", 
            RowBox[{"y", "[", "t", "]"}]}], ",", 
           RowBox[{"gx", "\[Rule]", 
            RowBox[{"gx", "[", "t", "]"}]}], ",", 
           RowBox[{"gy", "\[Rule]", 
            RowBox[{"gy", "[", "t", "]"}]}], ",", 
           RowBox[{"gz", "\[Rule]", 
            RowBox[{"gz", "[", "t", "]"}]}]}], "}"}]}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gx", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10000", "*", 
         RowBox[{"(", 
          RowBox[{"Qcg", "-", 
           RowBox[{"gx", "[", "t", "]"}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gy", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10000", "*", 
         RowBox[{"(", 
          RowBox[{"Qdg", "-", 
           RowBox[{"gy", "[", "t", "]"}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gz", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10000", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Qcg", "*", "g"}], "+", 
           RowBox[{"Qdg", "*", 
            RowBox[{"(", 
             RowBox[{"1", "-", "g"}], ")"}]}], "-", 
           RowBox[{"gz", "[", "t", "]"}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}]}], "}"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Equnstable", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"m", ",", 
     RowBox[{"{", 
      RowBox[{"81", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"count", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"R", "=", 
      RowBox[{"NDSolve", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"fullsys", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", "0", "]"}], "\[Equal]", 
             RowBox[{"0.0037", "*", "i"}]}], ",", 
            RowBox[{
             RowBox[{"y", "[", "0", "]"}], "\[Equal]", 
             RowBox[{"0.0037", "*", "i"}]}], ",", 
            RowBox[{
             RowBox[{"gx", "[", "0", "]"}], "\[Equal]", "0.5"}], ",", 
            RowBox[{
             RowBox[{"gy", "[", "0", "]"}], "\[Equal]", "0.5"}], ",", 
            RowBox[{
             RowBox[{"gz", "[", "0", "]"}], "\[Equal]", "0.5"}]}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "gx", ",", "gy", ",", "gz"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "1000000"}], "}"}], ",", 
        RowBox[{"Method", "\[Rule]", "\"\<StiffnessSwitching\>\""}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Equnstable", "[", 
       RowBox[{"[", "count", "]"}], "]"}], "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "[", "1000000", "]"}], "/.", 
         RowBox[{"R", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"y", "[", "1000000", "]"}], "/.", 
         RowBox[{"R", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"count", "=", 
      RowBox[{"count", "+", "1"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "80"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dots", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "Red", "]"}], ",", "Red", ",", 
        RowBox[{"Disk", "[", 
         RowBox[{
          RowBox[{"TernCoords", "[", 
           RowBox[{"1", ",", "0"}], "]"}], ",", "diskradius"}], "]"}]}], 
       "}"}], "]"}], ",", " ", 
     RowBox[{"(*", " ", "AllC", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
        RowBox[{"CapForm", "[", "\"\<Round\>\"", "]"}], ",", 
        RowBox[{"Thickness", "[", 
         RowBox[{"diskradius", "+", 
          RowBox[{"thickness", "*", "2"}]}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "Blue", "]"}], ",", "Blue", ",", 
        RowBox[{"Line", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"TernCoords", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "&"}], "@@@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0.66"}], "}"}]}], "}"}]}], "]"}]}], "}"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
        RowBox[{"CapForm", "[", "\"\<Round\>\"", "]"}], ",", 
        RowBox[{"Thickness", "[", 
         RowBox[{"diskradius", "+", 
          RowBox[{"thickness", "*", "2"}]}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "Blue", "]"}], ",", "Blue", ",", 
        RowBox[{"Line", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"TernCoords", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "&"}], "@@@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0.66"}], "}"}]}], "}"}]}], "]"}]}], "}"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
        RowBox[{"CapForm", "[", "\"\<Round\>\"", "]"}], ",", 
        RowBox[{"Thickness", "[", "diskradius", "]"}], ",", 
        RowBox[{"EdgeForm", "[", "Blue", "]"}], ",", "White", ",", 
        RowBox[{"Line", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"TernCoords", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "&"}], "@@@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0.66"}], "}"}]}], "}"}]}], "]"}]}], "}"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
        RowBox[{"CapForm", "[", "\"\<Round\>\"", "]"}], ",", 
        RowBox[{"Thickness", "[", 
         RowBox[{"diskradius", "+", 
          RowBox[{"thickness", "*", "2"}]}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "Blue", "]"}], ",", "Blue", ",", 
        RowBox[{"Line", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"TernCoords", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "&"}], "@@@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "]"}]}], "}"}], "]"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
        RowBox[{"CapForm", "[", "\"\<Round\>\"", "]"}], ",", 
        RowBox[{"Thickness", "[", 
         RowBox[{"diskradius", "+", 
          RowBox[{"thickness", "*", "2"}]}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "Blue", "]"}], ",", "Blue", ",", 
        RowBox[{"Line", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"TernCoords", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "&"}], "@@@", 
          RowBox[{"Join", "[", 
           RowBox[{"Eqstable", ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"0.2803120151092411`", ",", "0.36373187647092825`"}], 
              "}"}], "}"}]}], "]"}]}], "]"}]}], "}"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "Blue", "]"}], ",", "Blue", ",", 
        RowBox[{"Disk", "[", 
         RowBox[{
          RowBox[{"TernCoords", "[", 
           RowBox[{"0.2803120151092411`", ",", "0.36373187647092825`"}], 
           "]"}], ",", "diskradius"}], "]"}]}], "}"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
        RowBox[{"CapForm", "[", "\"\<Round\>\"", "]"}], ",", 
        RowBox[{"Thickness", "[", "diskradius", "]"}], ",", 
        RowBox[{"EdgeForm", "[", "Red", "]"}], ",", "Red", ",", 
        RowBox[{"Line", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"TernCoords", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "&"}], "@@@", 
          RowBox[{"Join", "[", 
           RowBox[{"Equnstable", ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"0.2803120151092411`", ",", "0.36373187647092825`"}], 
              "}"}], "}"}]}], "]"}]}], "]"}]}], "}"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "Red", "]"}], ",", "Red", ",", 
        RowBox[{"Disk", "[", 
         RowBox[{
          RowBox[{"TernCoords", "[", 
           RowBox[{"0.2803120151092411`", ",", "0.36373187647092825`"}], 
           "]"}], ",", "diskradius"}], "]"}]}], "}"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "Red", "]"}], ",", "Red", ",", 
        RowBox[{"Disk", "[", 
         RowBox[{
          RowBox[{"TernCoords", "[", 
           RowBox[{"0", ",", "0"}], "]"}], ",", "diskradius"}], "]"}]}], 
       "}"}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dp", "=", 
   RowBox[{"ListStreamPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Partition", "[", 
        RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", "vdata"}], ",", 
     RowBox[{"RegionFunction", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#1", "\[LessEqual]", 
         RowBox[{"1", "-", "#2"}]}], "&"}], ")"}]}], ",", " ", 
     RowBox[{"RegionFillingStyle", "\[Rule]", "None"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"error", ",", "xf"}], "}"}], "=", 
   RowBox[{"FindGeometricTransform", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Tan", "[", 
           RowBox[{"Pi", "/", "3"}], "]"}]}], "}"}], "/", "2"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ternplot", "=", 
   RowBox[{"Graphics", "[", 
    RowBox[{"GeometricTransformation", "[", 
     RowBox[{
      RowBox[{"First", "@", "dp"}], ",", "xf"}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"imageScBayes", "=", 
    RowBox[{"Show", "[", 
     RowBox[{"ternplot", ",", "dots", ",", "vlabels", ",", " ", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
      RowBox[{"PlotRangePadding", "->", ".1"}]}], "]"}]}], ";"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Sc_posbias_lambda025.pdf\>\"", ",", "imageScBayes"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.838088222129771*^9, 3.8380882523161287`*^9}, {
   3.838088309199883*^9, 3.838088512494357*^9}, {3.8381267829746037`*^9, 
   3.838126790038478*^9}, {3.838126834703959*^9, 3.838126835185442*^9}, {
   3.838126996745657*^9, 3.8381270038072443`*^9}, {3.838127061112376*^9, 
   3.838127089900515*^9}, {3.8381284978951893`*^9, 3.838128500019395*^9}, {
   3.838161560652719*^9, 3.838161585933136*^9}, {3.8381616369255133`*^9, 
   3.838161656618176*^9}, {3.838161687540237*^9, 3.8381618224987097`*^9}, {
   3.838161882538155*^9, 3.8381619082773447`*^9}, {3.838161958624341*^9, 
   3.838161959060997*^9}, 3.838162023296822*^9, {3.838162154251678*^9, 
   3.8381621555924377`*^9}, 3.8381622914451714`*^9, {3.83820743450924*^9, 
   3.838207439153728*^9}, {3.838207531806365*^9, 3.838207656393379*^9}, {
   3.8382076946202717`*^9, 3.83820769468141*^9}, {3.838207748786725*^9, 
   3.838207750671137*^9}, 3.838207789127788*^9, {3.8382078638741627`*^9, 
   3.8382079125451593`*^9}, {3.8382080623227043`*^9, 3.838208156999177*^9}, {
   3.8382085238526506`*^9, 3.838208553604843*^9}, {3.838208588834881*^9, 
   3.838208595168062*^9}, {3.8382094990033693`*^9, 3.838209519751189*^9}, {
   3.838209594301331*^9, 3.838209628960004*^9}, {3.838209852345359*^9, 
   3.8382098946804028`*^9}, {3.8382099897951*^9, 3.83821000855217*^9}, {
   3.838210118165619*^9, 3.838210118682735*^9}, {3.8382174812128563`*^9, 
   3.838217491363886*^9}, {3.8382185428979683`*^9, 3.8382185675044403`*^9}, {
   3.838218616552799*^9, 3.838218646056635*^9}, {3.838218724071685*^9, 
   3.838218732420599*^9}, {3.8382194337740583`*^9, 3.8382194387541103`*^9}, {
   3.83821950239361*^9, 3.838219502512866*^9}, {3.838219900244746*^9, 
   3.83821990452275*^9}, {3.838219943700129*^9, 3.83821994563266*^9}, {
   3.838220089966772*^9, 3.838220129673662*^9}, {3.8382202244015293`*^9, 
   3.8382202602696857`*^9}, {3.8382204711205*^9, 3.838220479078204*^9}, {
   3.83822052447682*^9, 3.838220527268655*^9}, {3.838220754638632*^9, 
   3.8382207623316298`*^9}, {3.838221821587743*^9, 3.83822184324819*^9}, {
   3.838223228456807*^9, 3.838223279883576*^9}, {3.838226321572248*^9, 
   3.838226325073913*^9}, {3.838236184284938*^9, 3.838236189353085*^9}, {
   3.838255101051396*^9, 3.838255101598159*^9}, {3.838953050340279*^9, 
   3.838953058074964*^9}, 3.838954195212384*^9, {3.8389545027599497`*^9, 
   3.838954512155746*^9}, 3.83895456767413*^9, {3.838955020052433*^9, 
   3.83895502247479*^9}, {3.8390707059377213`*^9, 3.839070706670919*^9}, {
   3.8390707506805887`*^9, 3.839070762080202*^9}, {3.8390709078082943`*^9, 
   3.839070951135901*^9}, {3.8390719323473597`*^9, 3.839071957032597*^9}, {
   3.839072117387454*^9, 3.8390721181372128`*^9}, {3.839072173799879*^9, 
   3.839072177951268*^9}, {3.839072210065528*^9, 3.839072273598919*^9}, {
   3.839072403386723*^9, 3.839072477678666*^9}, {3.83907254974762*^9, 
   3.8390725572516747`*^9}, {3.8390726059395113`*^9, 3.839072624347823*^9}, {
   3.839072660178562*^9, 3.839072737351678*^9}, {3.839072775069583*^9, 
   3.8390727824450607`*^9}, {3.839616743949945*^9, 3.839616758667541*^9}, {
   3.839616904498681*^9, 3.8396169323783073`*^9}, {3.83964004800683*^9, 
   3.839640051639905*^9}, {3.839640161333305*^9, 3.839640161893218*^9}, {
   3.839640204951076*^9, 3.8396402067078533`*^9}, {3.839640729702956*^9, 
   3.839640734595806*^9}, {3.839682386119172*^9, 3.839682423537232*^9}, {
   3.839682454654565*^9, 3.839682491279955*^9}, {3.8396826034596663`*^9, 
   3.839682643528119*^9}, {3.839682688649775*^9, 3.839682710525947*^9}, {
   3.839682762176908*^9, 3.839682765058998*^9}, {3.839682823789823*^9, 
   3.8396828465775547`*^9}, {3.839682901938583*^9, 3.839682940594144*^9}, {
   3.839682994382718*^9, 3.8396830156600647`*^9}, {3.840067587139323*^9, 
   3.84006759654465*^9}, {3.840067638924726*^9, 3.840067640630705*^9}, 
   3.8401104058306026`*^9, {3.842708475753792*^9, 3.8427085513669453`*^9}, {
   3.842708589996593*^9, 3.8427086085886383`*^9}, {3.8427108613163157`*^9, 
   3.842710864915057*^9}, {3.8427109223762608`*^9, 3.842710982626308*^9}, {
   3.842711212428472*^9, 3.8427112601190863`*^9}, 3.842711312376205*^9, {
   3.842711358557413*^9, 3.8427113881865597`*^9}, {3.842711541387554*^9, 
   3.842711556723341*^9}, {3.8427116129713078`*^9, 3.842711653432221*^9}, {
   3.8429733069426117`*^9, 3.842973317031885*^9}, {3.8429733527490377`*^9, 
   3.842973357722706*^9}, {3.842973797676798*^9, 3.842974021693684*^9}, {
   3.842976448446341*^9, 3.842976479576915*^9}, {3.842976522903619*^9, 
   3.842976530428916*^9}, 3.842976587796625*^9, {3.8434242638710318`*^9, 
   3.843424275490192*^9}, {3.8434254043282633`*^9, 3.843425407451374*^9}, {
   3.843425464789012*^9, 3.843425468657709*^9}, {3.848762746060822*^9, 
   3.84876274979382*^9}, {3.848762798120015*^9, 3.8487628263403177`*^9}, {
   3.8487628685415087`*^9, 3.8487628717376413`*^9}, {3.848762931296074*^9, 
   3.848762952236067*^9}, {3.848763024498723*^9, 3.8487630435030203`*^9}, {
   3.848763108128389*^9, 3.848763111429266*^9}, 3.848763341485203*^9, {
   3.848763485586863*^9, 3.848763488223282*^9}, {3.848763617847637*^9, 
   3.848763618125536*^9}, {3.848763650921129*^9, 3.848763653638751*^9}, {
   3.848763825144724*^9, 3.848763828204967*^9}, {3.848835428963217*^9, 
   3.848835463711076*^9}, {3.848835742184875*^9, 3.848835766804637*^9}, {
   3.848835828311469*^9, 3.848835831100791*^9}, {3.848835885946536*^9, 
   3.848835886649035*^9}, {3.848836026489702*^9, 3.848836047071402*^9}, {
   3.848836116951757*^9, 3.848836117077009*^9}, {3.8488361927481813`*^9, 
   3.8488361932566233`*^9}, {3.848836231650642*^9, 3.848836239269665*^9}, {
   3.848836271055252*^9, 3.848836271476265*^9}, {3.848836321109336*^9, 
   3.848836361128324*^9}, {3.848836476519603*^9, 3.848836498745101*^9}, {
   3.848836531290917*^9, 3.848836534717804*^9}, 3.8488371036058197`*^9, {
   3.848837331562241*^9, 3.848837351302252*^9}, {3.8488374983532457`*^9, 
   3.848837544843758*^9}, {3.848873642012603*^9, 3.848873672175713*^9}, {
   3.848873770204471*^9, 3.848873776472554*^9}, {3.8488739538956633`*^9, 
   3.848873954522715*^9}, {3.8488739943022947`*^9, 3.8488739944168873`*^9}, 
   3.8488740559074707`*^9, {3.8488741011215*^9, 3.8488741195978394`*^9}, {
   3.848874350253869*^9, 3.8488743927522917`*^9}, 3.8488744626655607`*^9, {
   3.84887456432607*^9, 3.848874611953916*^9}, {3.8488747354125137`*^9, 
   3.8488747441123734`*^9}, {3.848874780539756*^9, 3.848874788208589*^9}, {
   3.848874820127842*^9, 3.848874835270466*^9}, {3.848874869052108*^9, 
   3.8488748977790937`*^9}, {3.8488749376555347`*^9, 3.848875029353211*^9}, {
   3.848875439597324*^9, 3.8488754527370567`*^9}, {3.848875684717999*^9, 
   3.848875687207698*^9}, {3.848876107931931*^9, 3.848876114241179*^9}, 
   3.848876234515842*^9, {3.8488762687085123`*^9, 3.848876271105789*^9}, {
   3.848876569132053*^9, 3.8488765842109337`*^9}, {3.848876670530313*^9, 
   3.8488766974551277`*^9}, {3.848876831396037*^9, 3.848876844346902*^9}, {
   3.84887706351565*^9, 3.848877065872643*^9}, {3.8488778349683*^9, 
   3.8488778425875263`*^9}, {3.848877901951564*^9, 3.848877916652953*^9}, {
   3.848878645245513*^9, 3.8488786549285927`*^9}, {3.848878709915331*^9, 
   3.8488787133999977`*^9}, {3.848878769097322*^9, 3.848878776432296*^9}, {
   3.848878810582653*^9, 3.8488788133528*^9}, {3.8488788702908916`*^9, 
   3.8488788999389143`*^9}, {3.8488790096451807`*^9, 3.848879026466613*^9}, {
   3.848879118562162*^9, 3.8488791308566236`*^9}, {3.848879324005397*^9, 
   3.8488793369758673`*^9}, {3.848879410518117*^9, 3.84887941155343*^9}, {
   3.862311191808539*^9, 3.862311214556221*^9}, {3.8623112824884357`*^9, 
   3.862311295838866*^9}, 3.86231134623428*^9, 3.862311401155952*^9, {
   3.898128895805007*^9, 3.89812891335282*^9}, {3.8981289461800747`*^9, 
   3.898128962346344*^9}},
 CellLabel->
  "In[607]:=",ExpressionUUID->"cf18a8f7-848a-4c8e-aed1-a975d7cb53ab"],

Cell[BoxData[
 RowBox[{"positive", " ", "Scoring", " ", "with"}]], "Output",
 CellChangeTimes->{
  3.848763656063375*^9, 3.848763720225811*^9, 3.8487638306404448`*^9, 
   3.848835350398657*^9, 3.84883544230156*^9, 3.848835659097596*^9, {
   3.8488357463380623`*^9, 3.848835773852509*^9}, 3.848835889760317*^9, 
   3.8488360497034597`*^9, {3.8488360978084707`*^9, 3.848836119327351*^9}, {
   3.848836173721614*^9, 3.848836195615533*^9}, 3.848836241405581*^9, 
   3.848836273597745*^9, {3.848836327159362*^9, 3.848836363706596*^9}, {
   3.848836515905221*^9, 3.848836537303319*^9}, 3.848837073771819*^9, 
   3.8488371058116407`*^9, 3.8488373618643436`*^9, 3.848837396368464*^9, 
   3.848837547688808*^9, 3.848873549342561*^9, 3.848873675213175*^9, 
   3.848873780061808*^9, 3.848873958450509*^9, 3.8488739967935*^9, 
   3.848874058760889*^9, {3.8488741086008873`*^9, 3.8488741215799313`*^9}, 
   3.84887428231129*^9, 3.8488743982452106`*^9, 3.848874476676173*^9, 
   3.8488745068283997`*^9, 3.848874616813271*^9, 3.8488746887913017`*^9, 
   3.848874750753879*^9, 3.848874790695221*^9, 3.8488748373150787`*^9, 
   3.848874900290766*^9, {3.848874961980743*^9, 3.848874980129434*^9}, 
   3.84887503238456*^9, 3.848875689228631*^9, 3.848876119824545*^9, 
   3.8488762516529837`*^9, 3.848876590198062*^9, 3.848876681022678*^9, 
   3.848876846579343*^9, 3.848877069799941*^9, 3.848877976780819*^9, 
   3.8488783581107264`*^9, 3.848878662622942*^9, 3.848878717879529*^9, 
   3.8488787786565113`*^9, 3.848878815867741*^9, 3.848878887447898*^9, 
   3.848878921382593*^9, 3.848879030969017*^9, 3.848879133186596*^9, 
   3.862311133550385*^9, 3.8623113056444387`*^9, 3.8623113490877*^9, 
   3.866552223033244*^9, 3.8981289283330517`*^9, 3.898128991280249*^9},
 CellLabel->
  "Out[607]=",ExpressionUUID->"01d9a801-365a-472d-9d9c-496fdadc6ba1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 StyleBox[
  RowBox[{"Scoring", " ", "with", " ", "negative", " ", "bias"}], 
  "Section"], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bias", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]", "=", "0.25"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{
    RowBox[{"x", "*", 
     RowBox[{"gx", "[", "t", "]"}]}], "+", 
    RowBox[{"y", "*", 
     RowBox[{"gy", "[", "t", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "x", "-", "y"}], ")"}], "*", 
     RowBox[{"gz", "[", "t", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gb", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Lambda]"}], ")"}], "*", "g"}], "+", 
    RowBox[{"\[Lambda]", "*", "bias"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pcg", "=", 
   RowBox[{"\[Epsilon]", "*", 
    RowBox[{"gb", "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Epsilon]", "*", "gb"}], "+", 
       RowBox[{"e", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "gb"}], ")"}]}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pdg", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Epsilon]"}], ")"}], "*", 
    RowBox[{"gb", "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Epsilon]"}], ")"}], "*", "gb"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "e"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "gb"}], ")"}]}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pcb", "=", "Pcg"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pdb", "=", "Pdg"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Qcg", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "*", "Pcg"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Epsilon]"}], ")"}], "*", "Pdg"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Qdg", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "e"}], ")"}], "*", "Pdg"}], "+", 
     RowBox[{"e", "*", "Pcg"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Qcb", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "*", "Pcb"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Epsilon]"}], ")"}], "*", "Pdb"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Qdb", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "e"}], ")"}], "*", "Pdb"}], "+", 
     RowBox[{"e", "*", "Pcb"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"repsys", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"gx", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"Qcg", "-", 
       RowBox[{"gx", "[", "t", "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gy", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"Qdg", "-", 
       RowBox[{"gy", "[", "t", "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gz", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"Qcg", "*", "g"}], "+", 
       RowBox[{"Qdg", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "g"}], ")"}]}], "-", 
       RowBox[{"gz", "[", "t", "]"}]}]}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"m", ",", 
     RowBox[{"{", 
      RowBox[{"5151", ",", "5"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"count", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"R", "=", 
      RowBox[{"NDSolve", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"repsys", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "\[Rule]", 
              RowBox[{"0.01", "*", "i"}]}], ",", 
             RowBox[{"y", "\[Rule]", 
              RowBox[{"0.01", "*", "j"}]}]}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"gx", "[", "0", "]"}], "\[Equal]", "0.1"}], ",", 
            RowBox[{
             RowBox[{"gy", "[", "0", "]"}], "\[Equal]", "0.2"}], ",", 
            RowBox[{
             RowBox[{"gz", "[", "0", "]"}], "\[Equal]", "0.3"}]}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"gx", ",", "gy", ",", "gz"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "100000"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"M", "[", 
       RowBox[{"[", "count", "]"}], "]"}], "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0.01", "*", "i"}], ",", 
        RowBox[{"0.01", "*", "j"}], ",", 
        RowBox[{
         RowBox[{"gx", "[", "100000", "]"}], "/.", 
         RowBox[{"R", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"gy", "[", "100000", "]"}], "/.", 
         RowBox[{"R", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"gz", "[", "100000", "]"}], "/.", 
         RowBox[{"R", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"count", "=", 
      RowBox[{"count", "+", "1"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "100"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "0", ",", 
      RowBox[{"100", "-", "i"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pix", "=", 
   RowBox[{
    RowBox[{"r", "*", 
     RowBox[{"(", 
      RowBox[{"x", "+", 
       RowBox[{"gx", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "x", "-", "y"}], ")"}]}]}], ")"}]}], "-", "1"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"piy", "=", 
   RowBox[{"r", "*", 
    RowBox[{"(", 
     RowBox[{"x", "+", 
      RowBox[{"gy", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "x", "-", "y"}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"piz", "=", 
   RowBox[{
    RowBox[{"r", "*", 
     RowBox[{"(", 
      RowBox[{"x", "+", 
       RowBox[{"gz", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "x", "-", "y"}], ")"}]}]}], ")"}]}], "-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"gx", "*", "x"}], "+", 
      RowBox[{"gy", "*", "y"}], "+", 
      RowBox[{"gz", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "x", "-", "y"}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"pi", "=", 
   RowBox[{
    RowBox[{"x", "*", "pix"}], "+", 
    RowBox[{"y", "*", "piy"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "x", "-", "y"}], ")"}], "*", "piz"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"xdot", "=", 
   RowBox[{"x", "*", 
    RowBox[{"(", 
     RowBox[{"pix", "-", "pi"}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ydot", "=", 
   RowBox[{"y", "*", 
    RowBox[{"(", 
     RowBox[{"piy", "-", "pi"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vdata", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "xdot", ",", "ydot"}], "}"}], "/.", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "gx", ",", "gy", ",", "gz"}], "}"}], 
          "\[Rule]", "#"}], "]"}], "&"}], "/@", "M"}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Stable", " ", "equilibria"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullsys", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"x", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x", "*", 
         RowBox[{"(", 
          RowBox[{"pix", "-", "pi"}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}], ",", 
          RowBox[{"gx", "\[Rule]", 
           RowBox[{"gx", "[", "t", "]"}]}], ",", 
          RowBox[{"gy", "\[Rule]", 
           RowBox[{"gy", "[", "t", "]"}]}], ",", 
          RowBox[{"gz", "\[Rule]", 
           RowBox[{"gz", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"y", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"y", "*", 
         RowBox[{"(", 
          RowBox[{"piy", "-", "pi"}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}], ",", 
          RowBox[{"gx", "\[Rule]", 
           RowBox[{"gx", "[", "t", "]"}]}], ",", 
          RowBox[{"gy", "\[Rule]", 
           RowBox[{"gy", "[", "t", "]"}]}], ",", 
          RowBox[{"gz", "\[Rule]", 
           RowBox[{"gz", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gx", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10000", "*", 
         RowBox[{"(", 
          RowBox[{"Qcg", "-", 
           RowBox[{"gx", "[", "t", "]"}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gy", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10000", "*", 
         RowBox[{"(", 
          RowBox[{"Qdg", "-", 
           RowBox[{"gy", "[", "t", "]"}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gz", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10000", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Qcg", "*", "g"}], "+", 
           RowBox[{"Qdg", "*", 
            RowBox[{"(", 
             RowBox[{"1", "-", "g"}], ")"}]}], "-", 
           RowBox[{"gz", "[", "t", "]"}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}]}], "}"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eqstable", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"m", ",", 
     RowBox[{"{", 
      RowBox[{"81", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"count", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"R", "=", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"fullsys", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"0.00402", "*", "i"}]}], ",", 
             RowBox[{
              RowBox[{"y", "[", "0", "]"}], "\[Equal]", 
              RowBox[{"0.00402", "*", "i"}]}], ",", 
             RowBox[{
              RowBox[{"gx", "[", "0", "]"}], "\[Equal]", "0.5"}], ",", 
             RowBox[{
              RowBox[{"gy", "[", "0", "]"}], "\[Equal]", "0.5"}], ",", 
             RowBox[{
              RowBox[{"gz", "[", "0", "]"}], "\[Equal]", "0.5"}]}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "gx", ",", "gy", ",", "gz"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "1000000"}], "}"}], ",", 
         RowBox[{"Method", "\[Rule]", "\"\<StiffnessSwitching\>\""}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eqstable", "[", 
        RowBox[{"[", "count", "]"}], "]"}], "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "1000000", "]"}], "/.", 
          RowBox[{"R", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"y", "[", "1000000", "]"}], "/.", 
          RowBox[{"R", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"count", "=", 
       RowBox[{"count", "+", "1"}]}], ";"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "80"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Unstable", " ", "equilibria"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullsys", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"x", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x", "*", 
          RowBox[{"(", 
           RowBox[{"pix", "-", "pi"}], ")"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "\[Rule]", 
            RowBox[{"x", "[", "t", "]"}]}], ",", 
           RowBox[{"y", "\[Rule]", 
            RowBox[{"y", "[", "t", "]"}]}], ",", 
           RowBox[{"gx", "\[Rule]", 
            RowBox[{"gx", "[", "t", "]"}]}], ",", 
           RowBox[{"gy", "\[Rule]", 
            RowBox[{"gy", "[", "t", "]"}]}], ",", 
           RowBox[{"gz", "\[Rule]", 
            RowBox[{"gz", "[", "t", "]"}]}]}], "}"}]}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"y", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"y", "*", 
          RowBox[{"(", 
           RowBox[{"piy", "-", "pi"}], ")"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "\[Rule]", 
            RowBox[{"x", "[", "t", "]"}]}], ",", 
           RowBox[{"y", "\[Rule]", 
            RowBox[{"y", "[", "t", "]"}]}], ",", 
           RowBox[{"gx", "\[Rule]", 
            RowBox[{"gx", "[", "t", "]"}]}], ",", 
           RowBox[{"gy", "\[Rule]", 
            RowBox[{"gy", "[", "t", "]"}]}], ",", 
           RowBox[{"gz", "\[Rule]", 
            RowBox[{"gz", "[", "t", "]"}]}]}], "}"}]}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gx", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10000", "*", 
         RowBox[{"(", 
          RowBox[{"Qcg", "-", 
           RowBox[{"gx", "[", "t", "]"}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gy", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10000", "*", 
         RowBox[{"(", 
          RowBox[{"Qdg", "-", 
           RowBox[{"gy", "[", "t", "]"}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}]}], "}"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gz", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10000", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Qcg", "*", "g"}], "+", 
           RowBox[{"Qdg", "*", 
            RowBox[{"(", 
             RowBox[{"1", "-", "g"}], ")"}]}], "-", 
           RowBox[{"gz", "[", "t", "]"}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{"x", "[", "t", "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{"y", "[", "t", "]"}]}]}], "}"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Equnstable", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"m", ",", 
     RowBox[{"{", 
      RowBox[{"81", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"count", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"R", "=", 
      RowBox[{"NDSolve", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"fullsys", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", "0", "]"}], "\[Equal]", 
             RowBox[{"0.00402", "*", "i"}]}], ",", 
            RowBox[{
             RowBox[{"y", "[", "0", "]"}], "\[Equal]", 
             RowBox[{"0.00402", "*", "i"}]}], ",", 
            RowBox[{
             RowBox[{"gx", "[", "0", "]"}], "\[Equal]", "0.5"}], ",", 
            RowBox[{
             RowBox[{"gy", "[", "0", "]"}], "\[Equal]", "0.5"}], ",", 
            RowBox[{
             RowBox[{"gz", "[", "0", "]"}], "\[Equal]", "0.5"}]}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "gx", ",", "gy", ",", "gz"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "1000000"}], "}"}], ",", 
        RowBox[{"Method", "\[Rule]", "\"\<StiffnessSwitching\>\""}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Equnstable", "[", 
       RowBox[{"[", "count", "]"}], "]"}], "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "[", "1000000", "]"}], "/.", 
         RowBox[{"R", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"y", "[", "1000000", "]"}], "/.", 
         RowBox[{"R", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"count", "=", 
      RowBox[{"count", "+", "1"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "80"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dots", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "Red", "]"}], ",", "Red", ",", 
        RowBox[{"Disk", "[", 
         RowBox[{
          RowBox[{"TernCoords", "[", 
           RowBox[{"1", ",", "0"}], "]"}], ",", "diskradius"}], "]"}]}], 
       "}"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
        RowBox[{"CapForm", "[", "\"\<Round\>\"", "]"}], ",", 
        RowBox[{"Thickness", "[", 
         RowBox[{"diskradius", "+", 
          RowBox[{"thickness", "*", "2"}]}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "Blue", "]"}], ",", "Blue", ",", 
        RowBox[{"Line", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"TernCoords", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "&"}], "@@@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0.66"}], "}"}]}], "}"}]}], "]"}]}], "}"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
        RowBox[{"CapForm", "[", "\"\<Round\>\"", "]"}], ",", 
        RowBox[{"Thickness", "[", 
         RowBox[{"diskradius", "+", 
          RowBox[{"thickness", "*", "2"}]}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "Blue", "]"}], ",", "Blue", ",", 
        RowBox[{"Line", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"TernCoords", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "&"}], "@@@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0.66"}], "}"}]}], "}"}]}], "]"}]}], "}"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
        RowBox[{"CapForm", "[", "\"\<Round\>\"", "]"}], ",", 
        RowBox[{"Thickness", "[", "diskradius", "]"}], ",", 
        RowBox[{"EdgeForm", "[", "Blue", "]"}], ",", "White", ",", 
        RowBox[{"Line", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"TernCoords", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "&"}], "@@@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0.66"}], "}"}]}], "}"}]}], "]"}]}], "}"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
        RowBox[{"CapForm", "[", "\"\<Round\>\"", "]"}], ",", 
        RowBox[{"Thickness", "[", 
         RowBox[{"diskradius", "+", 
          RowBox[{"thickness", "*", "2"}]}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "Blue", "]"}], ",", "Blue", ",", 
        RowBox[{"Line", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"TernCoords", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "&"}], "@@@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "]"}]}], "}"}], "]"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
        RowBox[{"CapForm", "[", "\"\<Round\>\"", "]"}], ",", 
        RowBox[{"Thickness", "[", 
         RowBox[{"diskradius", "+", 
          RowBox[{"thickness", "*", "2"}]}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "Blue", "]"}], ",", "Blue", ",", 
        RowBox[{"Line", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"TernCoords", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "&"}], "@@@", 
          RowBox[{"Join", "[", 
           RowBox[{"Eqstable", ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"0.4477711126933915`", ",", "0.19802933167528428`"}], 
              "}"}], "}"}]}], "]"}]}], "]"}]}], "}"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "Blue", "]"}], ",", "Blue", ",", 
        RowBox[{"Disk", "[", 
         RowBox[{
          RowBox[{"TernCoords", "[", 
           RowBox[{"0.4477711126933915`", ",", "0.19802933167528428`"}], 
           "]"}], ",", "diskradius"}], "]"}]}], "}"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
        RowBox[{"CapForm", "[", "\"\<Round\>\"", "]"}], ",", 
        RowBox[{"Thickness", "[", "diskradius", "]"}], ",", 
        RowBox[{"EdgeForm", "[", "Red", "]"}], ",", "Red", ",", 
        RowBox[{"Line", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"TernCoords", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "&"}], "@@@", 
          RowBox[{"Join", "[", 
           RowBox[{"Equnstable", ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"0.4477711126933915`", ",", "0.19802933167528428`"}], 
              "}"}], "}"}]}], "]"}]}], "]"}]}], "}"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "Red", "]"}], ",", "Red", ",", 
        RowBox[{"Disk", "[", 
         RowBox[{
          RowBox[{"TernCoords", "[", 
           RowBox[{"0.4477711126933915`", ",", "0.19802933167528428`"}], 
           "]"}], ",", "diskradius"}], "]"}]}], "}"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Thickness", "[", "thickness", "]"}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "Red", "]"}], ",", "Red", ",", 
        RowBox[{"Disk", "[", 
         RowBox[{
          RowBox[{"TernCoords", "[", 
           RowBox[{"0", ",", "0"}], "]"}], ",", "diskradius"}], "]"}]}], 
       "}"}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dp", "=", 
   RowBox[{"ListStreamPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Partition", "[", 
        RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", "vdata"}], ",", 
     RowBox[{"RegionFunction", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#1", "\[LessEqual]", 
         RowBox[{"1", "-", "#2"}]}], "&"}], ")"}]}], ",", " ", 
     RowBox[{"RegionFillingStyle", "\[Rule]", "None"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"error", ",", "xf"}], "}"}], "=", 
   RowBox[{"FindGeometricTransform", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Tan", "[", 
           RowBox[{"Pi", "/", "3"}], "]"}]}], "}"}], "/", "2"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ternplot", "=", 
   RowBox[{"Graphics", "[", 
    RowBox[{"GeometricTransformation", "[", 
     RowBox[{
      RowBox[{"First", "@", "dp"}], ",", "xf"}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"imageScBayes", "=", 
   RowBox[{"Show", "[", 
    RowBox[{"ternplot", ",", "dots", ",", "vlabels", ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"PlotRangePadding", "->", ".1"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Sc_negbias_lambda025.pdf\>\"", ",", "imageScBayes"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.848879342863544*^9, 3.848879356156849*^9}, {
   3.848879399862752*^9, 3.848879401100889*^9}, {3.8488794977145653`*^9, 
   3.848879503641358*^9}, {3.848879660530377*^9, 3.8488796688394136`*^9}, 
   3.848879730200645*^9, 3.848881345426856*^9, {3.8623113899265757`*^9, 
   3.862311417145728*^9}, {3.898128999025929*^9, 3.898129018665978*^9}},
 CellLabel->
  "In[645]:=",ExpressionUUID->"6fcdc9f5-a89b-49d4-97ab-0bb118d33f71"],

Cell[BoxData[
 RowBox[{"negative", " ", "Scoring", " ", "with"}]], "Output",
 CellChangeTimes->{3.862311420045375*^9, 3.8665523284327374`*^9, 
  3.898129036266653*^9},
 CellLabel->
  "Out[645]=",ExpressionUUID->"8ed7182b-ea19-4d3c-8888-5b4235207f29"]
}, Open  ]]
},
WindowSize->{863, 767},
WindowMargins->{{Automatic, 111}, {Automatic, 0}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e631bc4b-3067-42ab-8042-d058c3f3a2fa"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 419, 9, 89, "Input",ExpressionUUID->"bf8c67b6-ba16-4aae-98d6-06b042e6a711"],
Cell[CellGroupData[{
Cell[1002, 33, 6661, 153, 349, "Input",ExpressionUUID->"af75f178-2c48-4a0b-afa3-52a0219f9de8"],
Cell[7666, 188, 189, 4, 34, "Output",ExpressionUUID->"eb866e2d-4f37-40f9-9c9f-a4b11d409527"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7892, 197, 35855, 920, 2206, "Input",ExpressionUUID->"cf18a8f7-848a-4c8e-aed1-a975d7cb53ab"],
Cell[43750, 1119, 1829, 27, 34, "Output",ExpressionUUID->"01d9a801-365a-472d-9d9c-496fdadc6ba1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45616, 1151, 28338, 817, 2206, "Input",ExpressionUUID->"6fcdc9f5-a89b-49d4-97ab-0bb118d33f71"],
Cell[73957, 1970, 250, 5, 34, "Output",ExpressionUUID->"8ed7182b-ea19-4d3c-8888-5b4235207f29"]
}, Open  ]]
}
]
*)

